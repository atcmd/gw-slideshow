
(function($){var gwSlideshow=function(element,options)
{element=$(element);var self=this;self.init=function(options)
{self.settings=$.extend({width:'300px',height:'80px',border:'1px solid #000000',bg_color:'#ffffff',delay:5000,transition:'fade',transition_speed:500,start:0,shuffle:false},options||{});self.listeners={};self.setupContainer();self.setupSlides();if(self.settings.shuffle)
{self.shuffle();}
self.slides[self.settings.start].show();self.showNext(self.settings.start);};self.setupContainer=function()
{element.css({width:self.settings.width,height:self.settings.height,border:self.settings.border,backgroundColor:self.settings.bg_color,position:'relative',overflow:'hidden'});if(self.settings.float||false)
{element.css('float',self.settings.float);}};self.setupSlides=function()
{self.slides=[];element.children('div').each(function()
{if($(this).hasClass('slide'))
{var s=$(this).css({width:self.settings.width,height:self.settings.height,backgroundColor:self.settings.bg_color,position:'absolute',top:0,left:0,overflow:'hidden',zIndex:1}).hide();self.slides.push(s);}});};self.shuffle=function()
{var o=self.slides;for(var j,x,i=o.length;i;j=parseInt(Math.random()*i),x=o[--i],o[i]=o[j],o[j]=x);self.slides=o;};self.showNext=function(num)
{var next=num+1;if(next==self.slides.length)
{next=0;}
self.doRotation(num,next);};self.showPrev=function(num)
{var next=num-1;if(next<0)
{next=self.slides.length;}
self.doRotation(num,next);};self.doFade=function(num1,num2,callback)
{self.slides[num1].fadeOut('slow');self.slides[num2].fadeIn('slow',callback);};self.doSlide=function(num,callback)
{var zmax=1;for(var i=0;i<self.slides.length;i++)
{var cur=self.slides[i].css('zIndex');zmax=(cur>zmax)?cur:zmax;}
self.slides[num].css('zIndex',zmax+1);self.slides[num].css('top','-'+self.settings.height).show();self.slides[num].animate({top:0},self.settings.transition_speed,callback);};self.doRotation=function(num1,num2)
{if(self.slides.length>1)
{setTimeout(function()
{self.triggerEvent('beforerotate',{prev_slide:num1,curr_slide:num2});var callback=function()
{self.showNext(num2);};if(self.settings.transition=='fade')
{self.doFade(num1,num2,function()
{callback();self.triggerEvent('rotate',{prev_slide:num1,curr_slide:num2});});}
else if(self.settings.transition=='slide')
{self.doSlide(num2,function()
{callback();self.triggerEvent('rotate',{prev_slide:num1,curr_slide:num2});});}},self.settings.delay);}};self.addListener=function(type,callback)
{if(!self.listeners[type]||true)
{self.listeners[type]=[];}
self.listeners[type].push(callback);};self.removeListener=function(type,callback)
{if((self.listeners[type]||false)&&self.listeners[type].length>0)
{var temp=[];for(var i=0;i<self.listeners[type].length;i++)
{if(self.listeners[type][i]!=callback)
{alert(callback+"\n\n NOT EQUAL TO \n\n"+self.listeners[type][0]);temp.push(self.listeners[type][i]);}}
self.listeners[type]=temp;}};self.triggerEvent=function(type,params)
{if((self.listeners[type]||false)&&self.listeners[type].length>0)
{switch(type)
{case'beforerotate':for(var i=0;i<self.listeners[type].length;i++)
{self.listeners[type][i](params.prev_slide,params.curr_slide,self);}
break;case'rotate':for(var i=0;i<self.listeners[type].length;i++)
{self.listeners[type][i](params.prev_slide,params.curr_slide,self);}
break;}}};self.init(options);};$.fn.gwSlideshow=function(options)
{return this.each(function()
{var element=$(this);if(element.data('gwSlideshow'))return;var slideshow=new gwSlideshow(this,options);element.data('gwSlideshow',slideshow);});};})(jQuery);